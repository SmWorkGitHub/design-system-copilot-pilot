---
seo:
  title: HPE GreenLake Audit Logging Standard | HPE GreenLake Platform
toc:
  enable: true
---

# HPE GreenLake Audit Logging Standard

## Introduction

This document supplies requirements for audit logging of security\-relevant information in HPE GreenLake services.
The target audience is developers of HPE authored components.
Though logging may collect multiple types of information, such as debugging, reliability, or security tracking,
the focus of this document is on logging of security-relevant events.

The intent of the document is to ensure consistency of named/defined fields and to ensure that necessary information is recorded to meet the intended use cases outlined in this document.
This document does not address the operational aspects of log collection, viewing, or analysis.

While every piece of information about a given event can be recorded in an audit record, this results in performance degradation and a high degree of noise when trying to analyze audit records.
The document cannot provide specifics for every situation; every situation is different. Hence, this document provides general guidance and examples.

Developers need to understand the intended use cases for the audit records and supply sufficient information to address the scenarios provided.
For example, if there is a breach, the development team will be involved in reviewing the audit records to determine what nefarious actions have been attempted or executed by an attacker.
There needs to be sufficient information in the audit records to understand the exposure (and what exposure has not occurred).

For information about who this standard applies to, see the [HPE GreenLake Development Policy for Audit Logging](../../policies/audit_logging_policy.md).

## Audit Logging Overview

Production systems can generate enormous amounts of logging data and logging consumes resources such as processor
cycles and storage space. The amount of storage space that a log file requires and the overhead for an application
that is logging data are proportional to the amount of information that is logged.
Additionally, it can be difficult to sift through enormous amounts of data to find meaningful information.
Therefore, it is important to carefully consider which events and associated data need be logged.

The audit log should not include *everything* that happened in the environment (for example, it should not have
debugging information).
The goal is to minimize the amount of noise in the logs while ensuring that necessary information is recorded.
The audit log needs to be complete but not overwhelming. Only security-relevant events should be contained in
the audit log.

The audit log is intended to help security administrators understand what security-relevant actions have taken
place in a system, application, or service, especially those which may be indications of security incidents.
The audit log must minimally address:

+ Maintaining visibility of individual user actions for accountability
  + Linking security-relevant events to the initiating user
  + When a user takes an action, including state changes of persisted data, it should be recorded in the audit log. Being able to determine state changes per user operation requires a clear understanding of what users are doing.
+ The execution of privileged operations
+ Changes to resources and other security-relevant events
+ Ascertain the extent of damage when a breach occurs
+ Although the primary focus of the audit trail is to support individual user accountability, there are events generated by applications and services that are security-relevant and need to be recorded in the audit trail
+ Audit logs must be easily consumed by authorized HPE staff and customers.
  + The HPE view of audit records must be a superset of what customers can view. With each record containing a tenant ID and/or other identifying reference then isolation of log information should be straightforward. If a record lacks a proper identifier, only HPE can view it.
+ All records generated must indicate the tenant of the requester (or the tenant on behalf of which the action was performed) even if operating in "single tenant" mode. This information should be used to ensure that one customer cannot see another customer’s audit records.
+ The consumer must be able to understand the security-relevant actions performed by each user and should not require internal knowledge of the implementation to use the information.
+ The audit log information of one customer must not be visible by other customers.
+ Information from the audit log will be consumed by automatic analysis tools for intrusion detection and monitoring to meet regulatory compliance and identify suspicious events.

Microservices result in many individual services being called up and down the stack. If each microservice produces
audit records, there is the potential for substantial amounts of duplicate audit records.
Duplication of information should be avoided where possible. An audit record can be written at multiple places in the
stack and developers may need to consider multiple components to ensure that the same information is not repeated at multiple levels.
Ideally, a single audit log entry can be used for multiple security related items stemming from a single user\-initiated action.
There must be traceability across audit logs, for example timestamps must be coordinated and it must be possible to track
specific users across levels of the stack and across audit logs.

Changes to resources (including the audit log itself) must be included in the audit log.
This can include modification of configurations, directory permissions changes, sensitive data modification, or unauthorized access.
In many cases obtaining information (e.g., a GET call) does not need to be audited.
However, if security\-sensitive data is being returned (e.g., credentials) then the call should be audited.
For benign GET data, we can assume that a user login has been recorded to the audit log and that the user has retrieved data that
their authorizations permit.

The audit log record should include all relevant information to help the auditor understand the operation performed.
The resulting audit log entry should provide information to identify the user, the action, the object involved, the
IP (Internet Protocol) address of the location where the action took place, and the results of the requested action.

This document refers to a single, logical audit log however, the audit records are generated by many sources across the solution services and are stored in numerous different logs.
These logs may contain only security relevant records, only non-security relevant records (e.g., debug log or a combination of the two (e.g., syslog) or a combination of the two.
The focus of this document is on the contents of audit records produced in HPE authored code.
However, consideration is needed for the collection and filtering of security relevant audit records from across numerous logs, which comprise the audit log.
The audit log, with non-security relevant records filtered out, can then be sent to tooling that examines and detects anomalous events or defined security issues.

## Requirements for Audit Logging in GreenLake

Logging service APIs (application programming interfaces) such as logz.io, Humio, etc. should be used to aggregate log information from GreenLake services.
In each component a logging capability must be enabled and connected to a logging service/repository.

The following list enumerates the questions that must be answered when an audit event occurs, and an audit record is produced.
See [Appendix A Audit Record Attributes, field types and definitions.](#appendix-a-audit-record-attributes)

+ When did the event occur?
  + Date and timestamp
    + The timestamp must be kept in (Coordinated Universal Time, offset)
    + Need common format for sorting purposes and associations between logs
      + Timestamps must meet the requirements specified in [RFC 3339](https://datatracker.ietf.org/doc/html/rfc3339)
    + Time source must be synchronized using NTP and a reliable source
      + Must use internal system clock
+ Who is the initiating user?
  + All users must be uniquely identified
+ What subjects (e.g., users, services) are associated with the event (e.g., users)?
+ What objects/resources are associated with the event?
+ What type of action/task was requested/performed?
+ What type of event occurred (event type)?
+ What is the outcome of the action (success or failure)?
+ Where did the event occur (e.g., IP address, system, service)?
+ Where is the source of the event (e.g., caller IP address, system, service)?
+ Was access to resources a success or failure?
+ What changes were made to resources including protected filesystems and configurations?
+ What authorization / privileged actions were attempted or performed?

The following list is non\-exhaustive, providing more details/examples of the types of information that should be included in the
audit log to adequately satisfy security needs.

+ Every security-relevant action that an individual user or autonomous service performs, to provide non\-repudiation and individual accountability
  + User authentication (login/logout) successes and failures
  + User authorization and access control successes and failures
  + A user account password is set or changed
  + Provide irrefutable evidence of what actions (including creation of information and approving changes) an individual (or process acting on behalf of an individual) has performed
  + LDAP server authentication failures
+ Changes to user accounts
  + User account is created, changed, deleted, or renamed
  + User account is disabled or enabled
  + User account is locked out or unlocked
  + Creation, deletion, or modification of groups
  + Access role modifications (e.g., changes to a user’s roles)
  + Modification of profiles
  + Modification of ACLs (access control lists)
  + Changes to privileges assigned to account user
  + Modification of passwords or password attributes / policy
  + Modification of certificates
+ Privileged actions through both elevation and direct admin access
  + Elevation of privilege
  + All admin-level commands
+ Every action that changes the environment/services or configuration
  + Security policy or auditing changes
  + A role is added or removed
  + Privileges associated with a role are modified
  + Time/clock change
  + Permissions changed for users
  + Creation/modification/deletion of resources and services
  + File Integrity changes (requires a file integrity tool)
  + Security configuration/policy changes
  + TPM (Trusted Platform Module) changes
+ Cryptographic configurations
  + Change of keys or certificates
    + Updates to CRL
  + Component inventory changes
  + Configuration settings
+ Software/firmware updates/downgrades
+ Backup/restore
+ Direct access and changes to databases that bypass applications
+ Database updates via batch files
+ Critical application record changes
+ Audit related actions
  + Administrative manipulation/changes of the audit log
  + Clearing and deleting of audit logs or alerts
  + Starting or stopping the audit function
  + Viewing of audit log
+ Service Failures
  + Unavailability of the service
+ Regulatory compliance Information

Optional events \- optional events may be present and enabled through configuration options to
generate additional/more detailed records, for example in the case of suspected breach.

## Excluded Information

Equally important as what is included in the audit log is ensuring that certain sensitive or personal information is
not included in the audit log. It is imperative that security\-critical values/information (e.g., passwords,
keys, system secrets) not be included in the audit log. Logging sensitive data can pose a security risk.
Therefore, the following types of information must NOT be recorded in an audit log:

+ Passwords/keys
+ Session IDs
+ Sensitive information (e.g., credentials, payment methods such as credit cards / bank account numbers, intellectual property)
+ Secrets

Though it is preferable not to include personal data (e.g., email addresses, phone numbers, and
account information) in the audit log, it is not strictly prohibited.

+ Inclusion must be minimized
+ If personal data is included, access must be limited, and the logs must be sufficiently protected
+ When possible, the personal data data should undergo pseudonymization resulting in the personal data data being replaced by an artificial identifier (such as a hash value)

## Documentation

The objective of auditing is to provide the consumer with useful information to help identify security anomalies and
potential incidents. The audit information should also allow an investigator to understand actions taken and resources
tampered with after a breach has been identified.

For the purposes of this document, the location and format of the documentation is not specified since these may differ based upon the the target consumers.
For instance, if only intended for developers, documentation on a wiki may be sufficient.
If the consumer is an end user (HPE customer) then this information must appear in customer documentation.

Each service must define the types of events that should be generated to meet the objectives. The events that the service
is capable of generating must be described in documentation for the consumer. The meaning of each field in the audit
record must be described and the potential content for each field must also be described.

Guidance and rationale must be provided describing the security ramifications of events and patterns of inappropriate
or unusual activity that may indicate a security issue. Guidance must be provided about the types of events that should
result in alerts.

The documentation should also explain how the consumer should respond to events
that are suspicious individually and those that become suspicious when they
occur repeatedly.
Guidance must be provided to analyze and remediate the concerns identified. This might also
include a list of the severity generally associated with particular patterns. For example, a couple of failed login
attempts presents a low probability of a security incident. However, hundreds of failed login attempts or nearly
parallel failed login attempts across many users presents a high probability of a security incident and requires further investigation.

## Anonymization

Some customers may place restrictions on information that can be included in the audit log. For example, IP addresses may
be considered personal data.
This sensitive data may be anonymized. Or, if the data may be needed, pseudonymization may be used to allow identification
through indirect means by replacing an individual or attribute with a pseudonym.

## Audit Record Format

While this document is focused on audit fields, the construction of the audit record is important for post processing.
The two common approaches to record formatting are a pre\-defined fixed format or key: value pairs (as used in JSON representation)
More information can be found in [Logging](https://developer.greenlake.hpe.com/docs/greenlake/standards/ratified/logging/) and
["Cloud Service Debug Logging"](https://developer.greenlake.hpe.com/docs/greenlake/standards/ratified/logging/services/).

## Other Considerations

The sequence of events recorded in the audit log can be particularly important when tracking down security issues.
It is therefore critical that a reliable and consistent time source is used across services.
And lastly, it is critically important that the integrity and confidentiality of the audit logs be protected.
Individuals should not have access to write to the audit log.
Only the audit process should update the append\-only audit log.
Read\-only access to the audit logs should be restricted to authorized individuals.

## Glossary

+ Audit log or audit trail - Security-relevant audit records that provide documentary evidence of the sequence of activities that have occurred
+ Audit record - The significant attributes of a security-sensitive action or event that occurred, including a timestamp, user or service that invoked the action, the action attempted, and its success or failure
+ Event - An observable occurrence in a system
+ Logging audit events - Events that are significant and relevant to the security of systems and the privacy of individuals must log audit records

## References

["HPE GreenLake Development Policy for Logging"](https://developer.greenlake.hpe.com/docs/greenlake/standards/policies/logging-policy/)

["HPE Logging and Monitoring Specification"](https://hpe.sharepoint.com/sites/WW/cybersecurity/Pages/global\-security\-policy.aspx?ID=2876)

[HPE Common Cloud Services - Audit Trail APIs](https://docs.ccs.arubathena.com/audit-trail/)

[NIST SP 800\-92r1 initial public draft, Cybersecurity Log Management Planning Guide](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800\-92r1.ipd.pdf)

## Appendix A: Audit Record Attributes

### Infrastructure / Application Layer Auditing for HPE Authored Code

The following table provides the standard names for events. This list is provided to ensure consistency.
Use of differing names complicates analysis.
A timestamp is always required.
If the information for other fields is available, it should be provided.
If no information is available, the field should be omitted from the audit record.

|Audit Record Attributes (Fields) | Type  | Description                                                        | Constraints   |
|---------------------------------|-------|--------------------------------------------------------------------|---------------|
|*Source (Originator/Requester)*  |       |                                                                    |               |
|`subject`\*                      |String |The subject/producer of the event                                   |               |
|`user`                           |String |UID                                                                 |               |
|`requestroles`                   |String |The roles associated with the invoker that produced the event       |               |
|`requestprivileges`              |String |The privileges associated with the invoker that produced the event  |               |
|`requestingservice`              |String |Requesting application/source service name                         |               |
|`requestsource`                  |String |Request call string (REST API (parameters), RPC (parameters), ssh)  |               |
|`requestmethod`                  |String |Request method (e.g., GET, PUT, POST, DELETE)                       |               |
|`requestcookies`                 |String |Request cookies                                                     |               |
|`requesturl`                     |String |Request URL                                                         |               |
|`requestsource`                  |String |Request source (IP address, DNS name, host name, service name, etc.)|               |
|`requestport`                    |String |Source port number                                                  |               |
|                                 |       |                                                                    |               |
|*Destination / Invoker*          |       |                                                                    |               |
|`requestedcall`                  |String |Request call string (REST API (parameters), RPC (parameters), ssh)  |               |
|`destination`                    |String |Destination IP address (DNS name, host name, service name, etc.)   |               |
|`eventlocation`                   |String |Location of event (system service, IP, etc)                         |               |
|`destinationport`                |Int    |Destination port number                                             |               |
|`l4protocol`                     |String |Layer 4 protocol (UDP, TCP, etc.)                                   |               |
|`protocolbinding`                |String |Network protocol/binding (TLS, ssh, etc.)                            |               |
|`encryption`                     |String |Encryption used (e.g., TLS 1.2)                                     |               |
|`destinationservice`             |String |Destination service name                                            |               |
|`destinationuserroles`           |String |Destination user roles                                              |               |
|`destinationuserprivs`           |String |Destination user privileges                                         |               |
|`apicallresult`                  |String |Success or failure of API call and reason for failure               |               |
|`eventcount`                     |String |Event count (how many times event occurred, default is 1)           |               |
|                                 |       |                                                                    |               |
|*General information*            |       |                                                                    |               |
|`id`\*                           |String |Identifies the event that occurred                                  |Source + ID must be unique|
|`source`\*                       |String/URI|Identifies the context in which the event happened               |Source + ID must be unique|
|`type`\*                         |String |Describes the type of event that occurred (reason event was generated)|Type*   |
|`time`\*                         |Timestamp|Timestamp of the event occurrence                                 |               |
|`invocationtime`                 |String |Timestamp when the request is initially processed                   |               |
|`completetime`                   |String |Timestamp when the request has completed                            |               |
|`specversion*`                   |String |Version of the CloudEvents spec                                     |               |
|`datacontenttype`*               |       |Type of data representation, defaults to JSON                       |               |
|`dataschema`*                    |String |Schema the data adheres to                                          |               |
|`securityrelevant`               |String |Some logs have security relevant and non-relevant log records. "yes" indicates this is a security relevant record, other values indicate not security relevant|               |
|                                 |       |                                                                    |               |
|*Objects / Resources*            |       |Resources (objects/resources associated with the event or acted upon)|            |
|`objname`                        |String |Name/pathname/URL/identifier                                        |               |
|`objtype`                        |String |Object type                                                         |               |
|`objowner`                       |String |Object owner                                                        |               |
|`objperms`                       |String |Object permissions                                                  |               |
|`objaccessresult`                |String |Success or failure for specific resource and reason for failure     |               |
|`assertedroles`                  |String |Roles asserted for requested access/actions on the object (i.e., the requestor would not have been able to access the resource without privileges)  |               |
|`assertedprivs`                  |String |Privileges asserted for requested access/actions on the object (i.e., the requestor would not have been able to access the resource without privileges)|               |
|`objchanges`                     |String |Changes made to the object (e.g., configuration)                    |               |
|`objcreatetime`                  |Timestamp|Object creation time                                              |               |
|`objmodtime`                     |Timestamp|Object modification time                                          |               |
|`objdeletetime`                  |Timestamp|Object deletion time                                              |               |

\*Indicates as defined in the ["CloudEvents version 1.0.3"](https://cloudevents.io/)

**Original publication date (yyyy-mm-dd):** 2024-08-28

**Revised:** 2024-07-10

**What's Changed** 2024-07-10

+ Added clarifications that the audit log can include events from multiple sources and both security-related and non-security related events and that this document focuses on HPE authored code.
+ Included guidance on using logging service APIs to aggregate log information from GreenLake services.
+ Added a new `securityrelevant` field to the audit record format.
+ Updated links and made minor text corrections and formatting improvements.
